<!DOCTYPE html>
<html>
  <head>
    
    <title>Crunchy Data PostgreSQL Operator Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.55.6" />
<title>Upgrade :: Crunchy Data PostgreSQL Operator Documentation</title>
<link rel="shortcut icon" href="https://crunchydata.github.io/postgres-operator/latest/favicon.png" type="image/x-icon" />
<link href="https://crunchydata.github.io/postgres-operator/latest/css/nucleus.css" rel="stylesheet">
<link href="https://crunchydata.github.io/postgres-operator/latest/theme-flex/style.css" rel="stylesheet">

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<link href="https://crunchydata.github.io/postgres-operator/latest/css/Fort-Fonts.css" rel="stylesheet">
<link href="https://crunchydata.github.io/postgres-operator/latest/css/custom.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<script src="https://crunchydata.github.io/postgres-operator/latest/js/jquery-2.x.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.bundle.min.js" integrity="sha384-zDnhMsjVZfS3hiP7oCBRmfjkQC4fzxVxFhBx8Hkz2aZX8gEvA/jsP3eXRCvzTofP" crossorigin="anonymous"></script>
<script src="https://crunchydata.github.io/postgres-operator/latest/js/main.js"></script>
<script src="https://crunchydata.github.io/postgres-operator/latest/js/toc.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/crunchydata.github.io\/postgres-operator\/latest";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/upgrade/">
    
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  
<a class="navbar-brand" href="https://www.crunchydata.com/"><img alt="Crunchy Data" src="https://crunchydata.github.io/postgres-operator/latest/images/logo.svg"></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <ul class="navbar-nav mr-auto"></ul>
  <span class="navbar-text">
      <nav class="shortcuts">
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/postgres-operator" target="_blank" rel="noopener">
                    <i class='fab fa-github'></i> <label>Source</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://kubernetes.io/docs/" target="_blank" rel="noopener">
                    <i class='fas fa-bookmark'></i> <label>Kubernetes</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/postgres-operator/blob/master/LICENSE.md" target="_blank" rel="noopener">
                    <i class='fas fa-file-contract'></i> <label>License</label>
                  </a>
              </li>
      </nav>
  </span>
</nav>

<article>
  <aside>

    <ul class="menu">
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="">
        </div>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/latest/js/lunr.min.js"></script>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/latest/js/auto-complete.js"></script>
        <link href="https://crunchydata.github.io/postgres-operator/latest/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/crunchydata.github.io\/postgres-operator\/latest";
          
        </script>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/latest/js/search.js"></script>
      </div>

      <hr>
      <a class="baselink" href="https://crunchydata.github.io/postgres-operator/latest/">Crunchy Data PostgreSQL Operator Documentation</a>
      <hr>
        <b>Available Formats</b>
        <nav class="downloads">
                <li class="" role="">
                    <a href="https://crunchydata.github.io/postgres-operator/latest/pdf/postgres_operator.pdf" target="_blank" rel="noopener">
                      <i class='fas fa-file-pdf'></i> <label>PDF</label>
                    </a>
                </li>
                <li class="" role="">
                    <a href="https://crunchydata.github.io/postgres-operator/latest/epub/postgres_operator.epub" target="_blank" rel="noopener">
                      <i class='fas fa-book'></i> <label>EPUB</label>
                    </a>
                </li>
        </nav>
        <hr>

      <b>Navigation</b>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/">Getting Started</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/">Design</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/designoverview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/designoverview/">
            Design
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/custom-config/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/custom-config/">
            Custom Configuration
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/custom-config-ssl/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/custom-config-ssl/">
            Custom SSL Configuration
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/multi-zone-design-considerations/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/multi-zone-design-considerations/">
            Multi-Zone Cloud Considerations
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/direct-api-calls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/direct-api-calls/">
            Rest API
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/backrest-s3-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/backrest-s3-configuration/">
            pgBackrest with S3
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/eventing/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/eventing/">
            Eventing
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/namespace/">
            Namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/olm/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/design/olm/">
            Operator Lifecycle Management Support
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/prereq/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/gettingstarted/prereq/">Prerequisites</a>

      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/installation/">Installation</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/">Install Operator Using Ansible</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/prerequisites/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/prerequisites/">
            Prerequisites
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-ansible/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-ansible/">
            Installing Ansible
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-operator/">
            Installing PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-metrics/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-metrics/">
            Installing Metrics Infrastructure
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/updating-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/updating-operator/">
            Updating PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/uninstalling-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/uninstalling-operator/">
            Uninstalling PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/uninstalling-metrics/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/uninstalling-metrics/">
            Uninstalling Metrics Stack
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-pgo-client/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-pgo-client/">Install `pgo` Client</a>

      </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/operator-install/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/operator-install/">
            Install Operator Using Bash
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/developer-setup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/developer-setup/">
            Developer Setup
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/">Configuration</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/compatibility/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/compatibility/">
            Compatibility Requirements
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/configuration/">
            Configuration Resources
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/pgo-yaml-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/pgo-yaml-configuration/">
            PGO YAML
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/overview/">Overview</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/node-affinitiy-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/node-affinitiy-overview/">
            Node Affinity in PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/storage-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/storage-overview/">
            Storage Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/custom-resource-definitions/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/custom-resource-definitions/">
            Custom Resource Definitions Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/scheduler-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/scheduler-overview/">
            PGO Scheduler Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/backup-restore-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/backup-restore-overview/">
            PostgreSQL Operator Backup and Restore Capability
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/postgres-operator-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/postgres-operator-overview/">
            PostgreSQL Operator Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/users-role-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/users-role-overview/">
            PostgreSQL Operator User Roles Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/failover-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/failover-overview/">
            Failover in the PostgreSQL Operator Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/postgres-operator-containers-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/postgres-operator-containers-overview/">
            PostgreSQL Operator Containers Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/overview/namespace-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/overview/namespace-overview/">
            PostgreSQL Operator Namespace Considerations Overview
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/">Operator Command Line Utility</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/pgo-cli-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/pgo-cli-overview/">
            PGO CLI Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/pgo-cli-global-variables/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/pgo-cli-global-variables/">
            PGO CLI Global Environment Variables
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/pgo-cli-global-flags/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/pgo-cli-global-flags/">
            PGO CLI Global Flags
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/common-pgo-cli-operations/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/common-pgo-cli-operations/">
            Common PGO CLI Operations
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/pgo-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/pgo-overview/">
            Operator CLI Overview
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/">Operator CLI</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo/">
            pgo
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_apply/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_apply/">
            pgo_apply
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_backup/">
            pgo_backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_benchmark/">
            pgo_benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_cat/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_cat/">
            pgo_cat
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_clidoc/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_clidoc/">
            pgo_clidoc
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create/">
            pgo_create
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_cluster/">
            pgo_create_cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_namespace/">
            pgo_create_namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_pgbouncer/">
            pgo_create_pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_pgorole/">
            pgo_create_pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_pgouser/">
            pgo_create_pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_pgpool/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_pgpool/">
            pgo_create_pgpool
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_policy/">
            pgo_create_policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_schedule/">
            pgo_create_schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_create_user/">
            pgo_create_user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete/">
            pgo_delete
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_backup/">
            pgo_delete_backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_benchmark/">
            pgo_delete_benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_cluster/">
            pgo_delete_cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_label/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_label/">
            pgo_delete_label
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_namespace/">
            pgo_delete_namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_pgbouncer/">
            pgo_delete_pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_pgorole/">
            pgo_delete_pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_pgouser/">
            pgo_delete_pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_pgpool/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_pgpool/">
            pgo_delete_pgpool
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_policy/">
            pgo_delete_policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_schedule/">
            pgo_delete_schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_upgrade/">
            pgo_delete_upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_delete_user/">
            pgo_delete_user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_df/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_df/">
            pgo_df
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_failover/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_failover/">
            pgo_failover
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_label/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_label/">
            pgo_label
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_load/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_load/">
            pgo_load
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_ls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_ls/">
            pgo_ls
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_reload/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_reload/">
            pgo_reload
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_restore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_restore/">
            pgo_restore
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_scale/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_scale/">
            pgo_scale
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_scaledown/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_scaledown/">
            pgo_scaledown
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show/">
            pgo_show
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_backup/">
            pgo_show_backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_benchmark/">
            pgo_show_benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_cluster/">
            pgo_show_cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_config/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_config/">
            pgo_show_config
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_namespace/">
            pgo_show_namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_pgorole/">
            pgo_show_pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_pgouser/">
            pgo_show_pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_policy/">
            pgo_show_policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_pvc/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_pvc/">
            pgo_show_pvc
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_schedule/">
            pgo_show_schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_upgrade/">
            pgo_show_upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_user/">
            pgo_show_user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_workflow/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_show_workflow/">
            pgo_show_workflow
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_status/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_status/">
            pgo_status
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_test/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_test/">
            pgo_test
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update/">
            pgo_update
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_cluster/">
            pgo_update_cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_namespace/">
            pgo_update_namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_pgorole/">
            pgo_update_pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_pgouser/">
            pgo_update_pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_update_user/">
            pgo_update_user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_upgrade/">
            pgo_upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_user/">
            pgo_user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_version/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_version/">
            pgo_version
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_watch/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/operatorcli/cli/pgo_watch/">
            pgo_watch
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/security/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/security/">RBAC Configuration</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/security/configure-postgres-operator-rbac/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/security/configure-postgres-operator-rbac/">
            Configuration of PostgreSQL Operator RBAC
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/security/install-postgres-operator-rbac/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/security/install-postgres-operator-rbac/">
            Installation of PostgreSQL Operator RBAC
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/security/api-encryption-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/security/api-encryption-configuration/">
            PostgreSQL Operator API Encryption Configuration
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/upgrade/" class="dd-item parent active
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/upgrade/">Upgrade</a>

      </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/contributing/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/contributing/">Contributing</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/contributing/documentation-updates/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/contributing/documentation-updates/">
            Updating Documentation
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/contributing/issues/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/contributing/issues/">
            Submitting Issues
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/contributing/pull-requests/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/contributing/pull-requests/">
            Submitting Pull Requests
          </a>
        </div>
    </li>
        </ul>
    </li>




      <hr><nav id="TableOfContents"></nav>



      <section>
      </section>
    </ul>
  </aside>
  <section class="page">

    <div class="nav-select">
      <center>Navigation :
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/gettingstarted/" >
   Getting Started</option>
    <option value="/installation/" >
   Installation</option>
    <option value="/configuration/" >
   Configuration</option>
    <option value="/overview/" >
   Overview</option>
    <option value="/operatorcli/" >
   Operator Command Line Utility</option>
    <option value="/security/" >
   RBAC Configuration</option>
    <option value="/upgrade/"  selected>
   Upgrade</option> 
  
    <option value="/contributing/" >
   Contributing</option>



        </select>
      </center>
    </div>

    
      <div id="top-bar">
        
          
          
          
        <div id="top-github-link">
          <a class="github-link" href="https://crunchydata.github.io/postgres-operator/latest/contributing/" target="blank">
            <i class="fa fa-info-circle"></i>
            
          </a>
          <a class="github-link" href="https://github.com/CrunchyData/postgres-operator/edit/develop/hugo/content/Upgrade/_index.md" target="blank">
            <i class="fa fa-code-fork"></i>
            
          </a>
        </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
            <span class="links">
            




 <a href='https://crunchydata.github.io/postgres-operator/latest/'>Crunchy Data Postgres Operator</a> > Upgrade

 


            </span>
        </div>

      </div>
    

    
    <div id="body-inner">

    <h1>Upgrade</h1>

    

    



<h2 id="upgrading-the-operator">Upgrading the Operator</h2>

<p>Various Operator releases will require action by the Operator administrator of your organization in order to upgrade to the next release of the Operator.  Some upgrade steps are automated within the Operator but not all are possible at this time.</p>

<p>This section of the documentation shows specific steps required to the
latest version from the previous version.</p>

<h3 id="upgrading-to-version-4-1-0-from-previous-versions">Upgrading to Version 4.1.0 From Previous Versions</h3>

<ul>
<li>The pgouser and pgorole files are no longer used for authentication with the server. The users and roles are now created using Kubernetes secrets and commands that are built into the operator. To migrate the users and roles that are currently setup in the operator you can run the upgrade script. The <code>upgrade-creds.sh</code> script in the <code>$PGOROOT/deploy</code> directory and will use the pgouser and pgorole files that are in <code>$PGOROOT/conf/postgres-operator</code> directory by default. You can also pass in the path to the files as command line arguments by running <code>$PGOROOT/deploy/upgrade-creds.sh /path/to/pgorole /path/to/pgouser</code>. The new secrets can be see by running <code>kubectl get secrets -n $PGO_OPERATOR_NAMESPACE</code>.</li>
</ul>

<h3 id="upgrading-to-version-3-5-0-from-previous-versions">Upgrading to Version 3.5.0 From Previous Versions</h3>

<ul>
<li>For clusters created in prior versions that used pgbackrest, you
will be required to first create a pgbasebackup for those clusters,
and after upgrading to Operator 3.5, you will need to restore those clusters
from the pgbasebackup into a new cluster with <em>&ndash;pgbackrest</em> enabled, this
is due to the new pgbackrest shared repository being implemented in 3.5.  This
is a breaking change for anyone that used pgbackrest in Operator versions
prior to 3.5.</li>
<li>The pgingest CRD is removed. You will need to manually remove it from any deployments of the operator after upgrading to this version. This includes removing ingest related permissions from the pgorole file. Additionally, the API server now
removes the ingest related API endpoints.</li>
<li>Primary and replica labels are only applicable at cluster creation and are not updated after a cluster has executed a failover. A new <em>service-name</em> label is applied to PG cluster components to indicate whether a deployment/pod is a primary or replica. <em>service-name</em> is also the label now used by the cluster services to route with. This scheme allows for an almost immediate failover promotion and avoids the pod having to be bounced as part of a failover.  Any existing PostgreSQL clusters will need to be updated to specify them as a primary or replica using the new <em>service-name</em> labeling scheme.<br /></li>
<li>The autofail label was moved from deployments and pods to just the pgcluster CRD to support autofail toggling.</li>
<li>The storage configurations in <em>pgo.yaml</em> support the MatchLabels attribute for NFS storage. This will allow users to have more than a single NFS backend,. When set, this label (key=value) will be used to match the labels on PVs when a PVC is created.</li>
<li>The UpdateCluster permission was added to the sample pgorole file to support the new pgo update CLI command. It was also added to the pgoperm file.</li>
<li>The pgo.yaml adds the PreferredFailoverNode setting. This is a Kubernetes selector string (e.g. key=value).  This value if set, will cause fail-over targets to be preferred based on the node they run on if that node is in the set of <em>preferred</em>.</li>
<li>The ability to select nodes based on a selector string was added.  For this to feature to be used, multiple replicas have to be in a ready state, and also at the same replication status.  If those conditions are not met, the default fail-over target selection is used.</li>
<li>The pgo.yaml file now includes a new storage configuration, XlogStorage, which when set will cause the xlog volume to be allocated using this storage configuration. If not set, the PrimaryStorage configuration will be used.</li>
<li>The pgo.yaml file now includes a new storage configuration, BackrestStorage, will cause the pgbackrest shared repository volume to be allocated using this storage configuration.</li>
<li>The pgo.yaml file now includes a setting, AutofailReplaceReplica, which will enable or disable whether a new replica is created as part of a fail-over. This is turned off by default.</li>
</ul>

<p>See the GitHub Release notes for the features and other notes about a specific release.</p>

<h3 id="upgrading-a-cluster-from-version-3-5-x-to-4-0">Upgrading a Cluster from Version 3.5.x to 4.0</h3>

<p>This section will outline the procedure to upgrade a given cluster created using Postgres Operator 3.5.x to 4.0.</p>

<p>1) Create a new Centos/Redhat user with the same permissions are the existing user used to install the Crunchy Postgres Operator. This is necessary to avoid any issues with environment variable differences between 3.5 and 4.0.</p>

<p>2) For the cluster(s) you wish to upgrade, scale down any replicas, if necessary, then delete the cluster</p>

<pre><code>pgo delete cluster &lt;clustername&gt;
</code></pre>

<p>IMPORTANT NOTES:
Please note the name of each cluster,
the namespace used,
and be sure not to delete the associated PVCs or CRDs!</p>

<p>3) Delete the 3.5.x version of the operator by executing:</p>

<pre><code>$COROOT/deploy/cleanup.sh
$COROOT/deploy/remove-crd.sh
</code></pre>

<p>4) Log in as your new Linux user and install the 4.0 Postgres Operator. Be sure to add the existing namespace to the list of watched namespaces (see the &lsquo;Getting Started-&gt;Design-&gt;Namespace&rsquo; section of this document for more information)  and make sure to avoid overwriting any existing data storage.</p>

<p>5) Once the Operator is installed and functional, create a new 4.0 cluster with the same name as was used previously. This will allow the new cluster to utilize the existing PVCs.</p>

<pre><code>pgo create cluster &lt;clustername&gt; -n &lt;namespace&gt;
</code></pre>

<p>6) Manually update the old leftover Secrets to use the new label as defined in 4.0:</p>

<pre><code>kubectl label secret/&lt;clustername&gt;-postgres-secret pg-cluster=&lt;clustername&gt; -n &lt;namespace&gt;
kubectl label secret/&lt;clustername&gt;-primaryuser-secret pg-cluster=&lt;clustername&gt; -n &lt;namespace&gt;
kubectl label secret/&lt;clustername&gt;-testuser-secret pg-cluster=&lt;clustername&gt; -n &lt;namespace&gt;
</code></pre>

<p>7) To verify cluster status, run
    pgo test <clustername> -n <namespace>
Output should be similar to:</p>

<pre><code>psql -p 5432 -h 10.104.74.189 -U postgres postgres is Working
psql -p 5432 -h 10.104.74.189 -U postgres userdb is Working
psql -p 5432 -h 10.104.74.189 -U primaryuser postgres is Working
psql -p 5432 -h 10.104.74.189 -U primaryuser userdb is Working
psql -p 5432 -h 10.104.74.189 -U testuser postgres is Working
psql -p 5432 -h 10.104.74.189 -U testuser userdb is Working
</code></pre>

<p>8) Scale up to the required number of replicas, as needed.</p>




    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="https://crunchydata.github.io/postgres-operator/latest/security/api-encryption-configuration/" title="PostgreSQL Operator API Encryption Configuration"> <i class="fa fa-chevron-left"></i><label>PostgreSQL Operator API Encryption Configuration</label></a>
    <a class="nav nav-next" href="https://crunchydata.github.io/postgres-operator/latest/contributing/" title="Contributing" style="margin-right: 0px;"><label>Contributing</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  

  </div>


	<div>
	</div>
</footer>

<link href="https://crunchydata.github.io/postgres-operator/latest/css/featherlight.min.css" rel="stylesheet">
<script src="https://crunchydata.github.io/postgres-operator/latest/js/featherlight.min.js"></script>

<script src="https://crunchydata.github.io/postgres-operator/latest/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>
